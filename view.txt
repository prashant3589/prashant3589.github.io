SELECT 
    pr.name AS PrincipalName,
    pr.type_desc AS PrincipalType,
    pe.permission_name,
    pe.state_desc AS PermissionState,
    pe.class_desc,
    OBJECT_NAME(pe.major_id) AS ObjectName
FROM sys.database_permissions pe
INNER JOIN sys.database_principals pr 
    ON pe.grantee_principal_id = pr.principal_id
WHERE pr.name = 'your_user_name';




SELECT 
    sp.name AS PrincipalName,
    sp.type_desc AS PrincipalType,
    spm.permission_name,
    spm.state_desc
FROM sys.server_permissions spm
INNER JOIN sys.server_principals sp 
    ON spm.grantee_principal_id = sp.principal_id
WHERE sp.name = 'your_login_name';



SELECT 
    dp1.name AS UserName,
    dp2.name AS RoleName
FROM sys.database_role_members drm
INNER JOIN sys.database_principals dp1 ON drm.member_principal_id = dp1.principal_id
INNER JOIN sys.database_principals dp2 ON drm.role_principal_id = dp2.principal_id
WHERE dp1.name = 'your_user_name';


SELECT 
    pr.name AS PrincipalName,
    pr.type_desc AS PrincipalType,
    pe.permission_name,
    pe.state_desc,
    pe.class_desc,
    OBJECT_NAME(pe.major_id) AS ObjectName
FROM sys.database_permissions pe
INNER JOIN sys.database_principals pr 
    ON pe.grantee_principal_id = pr.principal_id
ORDER BY pr.name, pe.permission_name;
